```dataviewjs
// ================
// é…ç½®é¡¹
// ================
const CATEGORY_TAGS = ["#A", "#B", "#C"] // ç‹¬ç«‹çš„ä¸‰çº§åˆ†ç±»æ ‡ç­¾
const KNOWLEDGE_PREFIX = "#é¢˜ç›®/çŸ¥è¯†ç‚¹/"
const DEFFICULTY_PREFIX = "#é¢˜ç›®/éš¾åº¦/"

// ================
// æ•°æ®å¤„ç†æž¶æž„
// ================
const classifyByTag = (tag) => (p) => p.file.tags.includes(tag)


// ================
// æ”¹è¿›çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼ˆå¸¦çŠ¶æ€ï¼‰
// ================
function createSeededRandom(seed) {
    // çº¿æ€§åŒä½™ç”Ÿæˆå™¨ (LCG) å‚æ•°
    const a = 1664525;
    const c = 1013904223;
    const m = Math.pow(2, 32);
    let state = seed;
	state = (a * state + c) % m;

    return function() {
        state = (a * state + c) % m;
        return state / m; // è¿”å›ž 0~1 ä¹‹é—´çš„æµ®ç‚¹æ•°
    };
}

// èŽ·å–å½“å‰æ—¥æœŸçš„ç§å­
const today = new Date().toISOString().slice(0, 10); // æ ¼å¼ï¼šYYYY-MM-DD
dv.paragraph(`***${today}***`)

const tendays = new Date().toISOString().slice(0, 9); // æ ¼å¼ï¼šYYYY-MM-DD
const seed = today.split('-').reduce((acc, val) => acc + parseInt(val), 0); // å°†æ—¥æœŸè½¬æ¢ä¸ºæ•°å­—ç§å­
const tdseed = tendays.split('-').reduce((acc, val) => acc + parseInt(val), 0); // å°†æ—¥æœŸè½¬æ¢ä¸ºæ•°å­—ç§å­
const seededRandom = createSeededRandom(seed);
const tdseededRandom = createSeededRandom(tdseed);

const pickOneRandom = (collection) => 
    collection.length > 0 ? [collection[Math.floor(seededRandom(seed) * collection.length)]] : [];

// ================
// æ ¸å¿ƒé€»è¾‘å®žçŽ°
// ================
const questionBank = dv.pages("#é¢˜ç›®/") 

// æž„å»ºæ™ºèƒ½æ•°æ®æº
const categorizedData = CATEGORY_TAGS.map(tag => ({
    icon: {
        "#A": "ðŸŸ¢", 
        "#B": "ðŸŸ¡", 
        "#C": "ðŸ”´"
    }[tag],
    name: `${tag[1]}`,
    items: questionBank.where(classifyByTag(tag))
}))

// åŠ¨æ€ç”ŸæˆçŸ¥è¯†ç‚¹æ± 
const knowledgePool = [...new Set(
    questionBank.flatMap(p => 
        p.file.tags
            .filter(t => t.startsWith(KNOWLEDGE_PREFIX))
            .map(t => t.split('/')[2])
    )
)]
const todayHotTopic = knowledgePool.length > 0 
    ? knowledgePool[Math.floor(tdseededRandom()*knowledgePool.length)] 
    : "æ‰€æœ‰é¢†åŸŸ"

// ================
// å¯è§†åŒ–æ¨¡å—
// ================
dv.header(1, `âŒ› é‡æ¸©`)
dv.table(
    ["åˆ†ç±»", "éšæœºæŠ½é¢˜", "éš¾åº¦"],
    categorizedData.map(section => {
        const caseFile = pickOneRandom(section.items)[0]
        return [
            `${section.icon} ${section.name} (${section.items.length})`,
            caseFile ? caseFile.file.link : "âŽ é¢˜åº“ç©ºç¼º",
            caseFile ? caseFile.file.tags
                .filter(t => t.startsWith(DEFFICULTY_PREFIX))
                .map(t => t.split('/')[2]).join(', ') : "--",
        ]
    })
)

// ================
// æ”¹è¿›çš„éšæœºæŒ‘é€‰å‡½æ•°
// ================
const pickRandomQuestions = (questions, count) => {
    // ä¸ºæ¯ä¸ªé—®é¢˜ç”Ÿæˆéšæœºé”®å€¼
    const withRandomKeys = questions.map(p => ({
        item: p,
        rand: seededRandom() // æ¯æ¬¡è°ƒç”¨ç”Ÿæˆæ–°çš„éšæœºæ•°
    }));
    
    // æŒ‰éšæœºé”®æŽ’åº
    const shuffled = withRandomKeys.sort(p => p.rand);
    return shuffled.slice(0, count).map(i => i.item);
};

// ================
// Hot100 é¢˜ç›®æŒ‘é€‰
// ================
const hot100Questions = dv.pages("#hot100");
const randomHot100Questions = pickRandomQuestions(hot100Questions, 3);

// å±•ç¤ºç»“æžœï¼ˆä¿æŒåŽŸæœ‰é€»è¾‘ä¸å˜ï¼‰
if (randomHot100Questions.length > 0) {
    dv.header(1, "ðŸ”¥ ä»Šæ—¥ Hot 100 æŽ¨è");
    dv.list(randomHot100Questions.map(p => p.file.link));
} else {
    dv.paragraph("ðŸ“­ ä»Šæ—¥æ²¡æœ‰ Hot 100 é¢˜ç›®æŽ¨èã€‚");
}

// ================
// èŽ·å–å½“å‰åæ—¥çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸ
// ================
const currentDate = new Date();
const currentYear = currentDate.getFullYear();
const currentMonth = currentDate.getMonth() + 1; // æœˆä»½ä»Ž 0 å¼€å§‹ï¼Œéœ€è¦åŠ  1
const currentDay = currentDate.getDate();

// è®¡ç®—å½“å‰åæ—¥çš„å¼€å§‹æ—¥å’Œç»“æŸæ—¥
const dayOfDecade = Math.floor((currentDay - 1) / 10) * 10 + 1;
const startDate = new Date(currentYear, currentMonth - 1, dayOfDecade);
const endDate = new Date(currentYear, currentMonth - 1, dayOfDecade + 9);

// æ ¼å¼åŒ–æ—¥æœŸä¸º YYYY/MM/DD
const formatDate = (date) => {
    const yyyy = date.getFullYear();
    const mm = String(date.getMonth() + 1).padStart(2, '0');
    const dd = String(date.getDate()).padStart(2, '0');
    return `${yyyy}/${mm}/${dd}`;
};

// èŽ·å–æ‰€æœ‰æ¯”è¾ƒæ–‡ä»¶
const allComparisonFiles = dv.pages("#æ¯”è¾ƒ/");

// ================
// æ£€æŸ¥é¢˜ç›®åœ¨å½“å‰åæ—¥å†…æ˜¯å¦å·²å®Œæˆ
// ================
const isCompletedInCurrentDecade = (problemNumber, requiredKnowledgeTag) => {
    // æŸ¥æ‰¾å¸¦æœ‰æ¯”è¾ƒæ ‡ç­¾çš„å¯¹åº”é¢˜å·æ–‡ä»¶
    const matchingFiles = allComparisonFiles.where(p => {
        // ä»Žæ–‡ä»¶åæå–é¢˜å·
        const fileNumberMatch = p.file.name.match(/^(\d+)\./);
        return fileNumberMatch && parseInt(fileNumberMatch[1]) === parseInt(problemNumber);
    });
    
    // æ£€æŸ¥ä»»ä½•åŒ¹é…çš„æ–‡ä»¶æ˜¯å¦åœ¨å½“å‰åæ—¥å†…ä¸”åŒ…å«ç›¸åŒçŸ¥è¯†ç‚¹æ ‡ç­¾
    return matchingFiles.some(p => {
        // èŽ·å–æ–‡ä»¶ä¸­çš„æ—¥æœŸæ ‡ç­¾
        const dateTag = p.file.tags.find(t => t.match(/^#\d{4}\/\d{2}\/\d{2}$/));
        if (!dateTag) return false;
        
        // æ£€æŸ¥æ˜¯å¦åŒ…å«ç›¸åº”çŸ¥è¯†ç‚¹æ ‡ç­¾
        if (!p.file.tags.includes(requiredKnowledgeTag)) return false;
        
        // è§£æžæ—¥æœŸæ ‡ç­¾
        const [year, month, day] = dateTag.substring(1).split('/').map(Number);
        const fileDate = new Date(year, month - 1, day);
        
        // æ£€æŸ¥æ—¥æœŸæ˜¯å¦åœ¨å½“å‰åæ—¥å†…
        return fileDate >= startDate && fileDate <= endDate;
    });
};

// ================
// åæ—¥ä¸“é¡¹é¢˜ç›®å±•ç¤ºï¼ˆæ·»åŠ å®Œæˆåˆ—ï¼‰
// ================
dv.header(1, `ðŸŒŸ åæ—¥ä¸“é¡¹ï¼š${todayHotTopic}`)

const currentKnowledgeTag = KNOWLEDGE_PREFIX + todayHotTopic;
const difficultyOrder = { "ç®€å•": 1, "ä¸­ç­‰": 2, "å›°éš¾": 3, "æœªçŸ¥": 4 };

const specialQuestions = questionBank
    .where(p => p.file.tags.includes(currentKnowledgeTag))
    .sort(p => {
        const diffTag = p.file.tags.find(t => t.startsWith(DEFFICULTY_PREFIX));
        const difficulty = diffTag ? diffTag.split("/").pop() : "æœªçŸ¥";
        return difficultyOrder[difficulty] || 4;
    }, "asc");

if (specialQuestions.length > 0) {
    dv.table(
        ["é¢˜ç›®é“¾æŽ¥", "éš¾åº¦ç­‰çº§", "å®Œæˆ"],
        specialQuestions.map(p => {
            // ä»Žæ–‡ä»¶åæå–é¢˜å·
            const problemNumberMatch = p.file.name.match(/^(\d+)\./);
            const problemNumber = problemNumberMatch ? problemNumberMatch[1] : null;
            
            // æ£€æŸ¥æ˜¯å¦å®Œæˆ
			const isCompleted = problemNumber && isCompletedInCurrentDecade(problemNumber, currentKnowledgeTag);

            
            return [
                p.file.link,
                p.file.tags.find(t => t.startsWith(DEFFICULTY_PREFIX))?.split("/").pop() || "æœªæ ‡æ³¨",
                isCompleted ? "âœ…" : "â¬œ"
            ];
        })
    );
}

// ================
// æœªå®Œæˆé¢˜ç›®å±•ç¤ºï¼ˆæ— ABCæ ‡ç­¾çš„é¢˜ç›®ï¼‰
// ================
const unfinishedQuestions = questionBank
    .where(p => !p.file.tags.some(t => CATEGORY_TAGS.includes(t))) // è¿‡æ»¤æ— ABCæ ‡ç­¾çš„é¢˜ç›®
    .sort(p => {
        const diffTag = p.file.tags.find(t => t.startsWith(DEFFICULTY_PREFIX));
        const difficulty = diffTag ? diffTag.split("/").pop() : "æœªçŸ¥";
        return difficultyOrder[difficulty] || 4;
    }, "asc"); // æŒ‰éš¾åº¦æŽ’åº

if (unfinishedQuestions.length > 0) {
    dv.header(1, "ðŸ“ æœªå®Œæˆé¢˜ç›®");
    dv.table(
        ["é¢˜ç›®é“¾æŽ¥", "éš¾åº¦ç­‰çº§", "å…³è”çŸ¥è¯†ç‚¹"],
        unfinishedQuestions.map(p => [
            p.file.link,
            p.file.tags.find(t => t.startsWith(DEFFICULTY_PREFIX))?.split("/").pop() || "æœªæ ‡æ³¨",
            p.file.tags
                .filter(t => t.startsWith(KNOWLEDGE_PREFIX))
                .map(t => t.split('/')[2])
                .join(', ') || "--"
        ])
    );
}


// ================
// æå–å¸¦ #æ¯”è¾ƒ/ æ ‡ç­¾ä¸” #YYYY/MM/DD æ ‡ç­¾åœ¨æœ¬æœˆçš„æ–‡ä»¶
// ================
const comparisonFiles = dv.pages("#æ¯”è¾ƒ/")
    .where(p => {
        const dateTag = p.file.tags.find(t => t.startsWith("#" + currentYear + "/"));
        if (!dateTag) return false;
        const [year, month] = dateTag.split('/').slice(0, 2);
        return parseInt(month) === currentMonth;
    });

// ================
// å±•ç¤ºç»“æžœ
// ================
dv.header(1, "ðŸ“Š æœ¬æœˆè¿›åº¦");
dv.paragraph(`\`\`\`progressbar\nid: progress-0\nkind: manual\nname: "è¿›åº¦({value}/{max})"\nvalue: ${comparisonFiles.length}\nmax: 100\nwidth: 60%\nbutton: false\n\`\`\``);

```